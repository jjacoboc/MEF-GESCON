<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/WEB-INF/template.xhtml">
    
    <ui:define name="content">
        <div class="layout-portlets-box">
            <div class="Container100">
                <div class="ContainerIndent TexAlCenter">
                    <f:loadBundle basename="pe.gob.mef.gescon.messages" var="msgs"/>
                    <f:view>
                    <h:form id="f">
                        <p:growl id="growl" showDetail="true"/>
                        
                        <p:panel header="#{msgs.om_lom_titulo}" styleClass="TexAlLeft">
                            <h:panelGrid columns="1">
                                <p:commandButton  value="Nuevo" actionListener="#{oportunidadMB.toSave}" update=":newDialogForm:pgNew, :newDialogForm:pgNewVinc" 
                                                  oncomplete="PF('newDialog').show();" styleClass="Fleft" icon="fa fa-plus white" 
                                                  rendered="true"/>
                                <p:dataTable id="tbl" value="#{oportunidadMB.listaOportunidadMejora}" var="row" paginator="true" rows="5" rowIndexVar="rowIndex" draggableColumns="true" reflow="true"
                                             rowStyleClass="#{row.nestado eq '0' ? 'rowInactive' : null}" paginatorPosition="top" emptyMessage="#{msgs.lbl_listavacia}">
                                    
                                    <p:column style="text-align: center; width: 120px;"  filterMatchMode="contains" filterStyle="width: 100px;text-transform: uppercase;" priority="1">
                                        
                                        <p:panel >
                                            
                                            <f:facet name="header" >
                                                <h:outputLabel value="#{row.vtitulo}" style="float:left;" />
                                            </f:facet>
                                            <h:panelGrid>                                        
                                              <h:outputText value="#{row.vcontenido}" escape="false" style="float:left;" />
                                            </h:panelGrid>
                                            <br/>       
                                            <f:facet name="footer" >
                                                                                               
                                                    <p:commandLink oncomplete="PF('viewDialog').show();" title="Ver Oportunidad de Mejora: #{row.vtitulo}"
                                                                   value="Ver" update=":viewDialogForm:pgView">
                                                        <h:outputText class="fa fa-check Fs16" />
                                                        <f:setPropertyActionListener value="#{row}" target="#{oportunidadMB.selectedOportunidadMejora}" />
                                                    </p:commandLink >
                                                    
                                                    <p:commandLink oncomplete="PF('confirmDelDlg').show();" title="Eliminar Oportunidad de Mejora: #{row.vtitulo}"
                                                                   value="Eliminar" >
                                                        <h:outputText class="fa fa-check Fs16" />
                                                        <f:setPropertyActionListener value="#{row}" target="#{oportunidadMB.selectedOportunidadMejora}" />
                                                    </p:commandLink >
                                                    
                                                    <p:commandLink oncomplete="PF('confirmDesDlg').show();" title="Desactivar Oportunidad de Mejora: #{row.vtitulo}"
                                                                   value="Desactivar" rendered="#{row.nestado eq 1}">
                                                        <h:outputText class="fa fa-check Fs16" />
                                                        <f:setPropertyActionListener value="#{row}" target="#{oportunidadMB.selectedOportunidadMejora}" />
                                                    </p:commandLink >
                                                    
                                                    <p:commandLink  oncomplete="PF('confirmActDlg').show();" title="Activar Oportunidad de Mejora: #{row.vtitulo}"
                                                                    value="Activar" rendered="#{row.nestado eq 0}">
                                                        <h:outputText class="fa fa-check Fs16" />
                                                        <f:setPropertyActionListener value="#{row}" target="#{oportunidadMB.selectedOportunidadMejora}" />
                                                    </p:commandLink >
                                                    
                                                    <p:commandLink value="AnÃƒÂ¡lisis">
                                                    </p:commandLink >
                                                    
                                                    <p:commandLink value="ImplementaciÃƒÂ³n">
                                                    </p:commandLink >
                                                                                       
                                            </f:facet>
                                            
                                        </p:panel>
                                        
                                    </p:column>
                                    
                                </p:dataTable>
                            </h:panelGrid>
                        </p:panel>
                    </h:form>

                    <p:dialog id="newDlg" header="#{msgs.om_lom_pnlNew}" widgetVar="newDialog" modal="true" appendTo="@(body)" showEffect="fade" hideEffect="fade" resizable="false" closable="true" style="font-size: 10px;">
                        <h:form id="newDialogForm">
                            <h:panelGrid id="pgNew"  columns="3">
                                 <h:outputLabel value="*"/>
                                 <h:outputLabel value="CategorÃƒÂ­a:" style="vertical-align: top"/>
                                <h:panelGroup>
                                    <p:commandButton value="Seleccionar CategorÃƒÂ­a" actionListener="#{oportunidadMB.loadTree}" oncomplete="PF('catDialog').show();" update=":catDialogForm:pgCat" />
                                    <p:spacer width="15"/>
                                    <h:outputText value="#{oportunidadMB.selectedCategoria.vnombre}" />
                                </h:panelGroup>
                            
                                <h:outputLabel value="*"/>
                                <h:outputLabel value="TÃƒÂ­tulo"/>
                                <p:inputText size="99" value="#{oportunidadMB.vtitulo}" maxlength="80"/>
                            
                                <p:spacer/>
                                <h:outputLabel value="Detalle:" style="vertical-align: top"/>
                                <h:panelGrid columns="1" cellspacing="0" cellpadding="0">
                                    <p:inputTextarea value="#{oportunidadMB.vdetalle}" rows="4" cols="66" style="font-weight: normal;"
                                                     counter="display" maxlength="400" counterTemplate="{0} caracteres restantes." />
                                    <h:outputText id="display"/>
                                </h:panelGrid>
                                
                                <h:outputLabel value="*"/>
                                <h:outputLabel value="Contenido" />
                                <p:editor id="editor" widgetVar="editorWidget" value="#{oportunidadMB.vcontenido}" width="600" /> 
                                 
                            </h:panelGrid>
                                                        
                            
                            <p:fieldset>
                                <h:panelGrid id="pgNewVinc" columns="1" cellpadding="0" cellspacing="0">
                                    
                                </h:panelGrid>
                            </p:fieldset>
     
                            
                            <h:panelGrid columns="2" width="100%">
                                <p:commandButton value="Registrar" actionListener="#{oportunidadMB.save}" update=":f:tbl, :f:growl"/>
                                <h:outputText value="(*) Datos obligatorios." style="font-size: 9px;float: right;"/>
                            </h:panelGrid>
                        </h:form>
                    </p:dialog>

                    <p:dialog id="viewDlg" header="Oportunidad de Mejora" widgetVar="viewDialog" modal="true" appendTo="@(body)" showEffect="fade" hideEffect="fade" resizable="false" closable="true" style="font-size: 10px;">
                       
                        <h:form id="viewDialogForm">
                            
                             <h:panelGrid id="pgView" columns="3">
                              
                                    <h:outputText value="#{msgs.icon_asterisk}"/>
                                    <h:outputText value="#{msgs.om_lom_categoria}"/>
                                    <h:outputText value="#{oportunidadMB.selectedOportunidadMejora.mtcategoria.vnombre}" />
                                    
                                    <h:outputText value="#{msgs.icon_asterisk}"/>
                                    <h:outputText value="#{msgs.om_lom_titulo}"/>
                                    <h:outputText value="#{oportunidadMB.selectedOportunidadMejora.vtitulo}" />
                                    
                                    <h:outputText value="#{msgs.icon_asterisk}"/>
                                    <h:outputText value="#{msgs.om_lom_detalle}"/>
                                    <h:outputText value="#{oportunidadMB.selectedOportunidadMejora.vdescripcion}" />
                                    
                                    <h:outputText value="#{msgs.icon_asterisk}"/>
                                    <h:outputText value="#{msgs.om_lom_contenido}"/>
                                    <h:outputText value="#{oportunidadMB.selectedOportunidadMejora.vcontenido}" escape="false" />
                                    
                             </h:panelGrid>    
                            
                        </h:form>
                        
                    </p:dialog>

                    <p:dialog id="editDlg" header="Oportunidad de Mejora" widgetVar="editDialog" modal="true" appendTo="@(body)" showEffect="fade" hideEffect="fade" resizable="false" closable="true" style="font-size: 10px;">
                        <h:form id="editDialogForm">
                            
                        </h:form>
                    </p:dialog>
                    
                    <p:dialog id="postDlg" header="Oportunidad de Mejora" widgetVar="postDialog" modal="true" appendTo="@(body)" showEffect="fade" hideEffect="fade" resizable="false" closable="true" style="font-size: 10px;">
                        <h:form id="postDialogForm">
                            
                        </h:form>
                    </p:dialog>

                    <p:dialog id="pickDlg" header="Oportunidad de Mejora Vinculadas" widgetVar="pickDialog" modal="true" appendTo="@(body)" showEffect="fade" hideEffect="fade" resizable="false" closable="true" style="font-size: 10px;">
                        <h:form id="pickDialogForm">
                            
                        </h:form>
                    </p:dialog>

                    <p:dialog id="catDlg" header="Seleccionar CategorÃƒÂ­a" widgetVar="catDialog" modal="true" appendTo="@(body)" showEffect="fade" hideEffect="fade" resizable="false" closable="true" style="font-size: 10px;">
                        <h:form id="catDialogForm">
                             <h:panelGrid id="pgCat" columns="1">
                                <h:outputText value="Categorias" style="font-weight: bold; text-decoration: underline;"/>
                                <p:tree id="cats" value="#{oportunidadMB.tree}" var="node" animate="true" cache="true"  
                                        selectionMode="single" style="width: 100%;border: 0;" dynamic="true" highlight="true">
                                    <p:ajax event="select" listener="#{oportunidadMB.onNodeSelect}" oncomplete="PF('catDialog').hide();" update=":newDialogForm:pgNew" />
                                    <p:treeNode expandedIcon="ui-icon ui-icon-folder-open" collapsedIcon="ui-icon ui-icon-folder-collapsed">
                                        <h:outputText value="#{node.vnombre}"/>
                                    </p:treeNode>
                                </p:tree>
                            </h:panelGrid>
                            
                           
                            
                        </h:form>
                    </p:dialog>

                    <p:confirmDialog appendTo="@(body)" message="Se procederÃƒÂ¡ a activar la oportunidad de mejora. Desea Continuar?" header="ACTIVAR OPORTUNIDAD DE MEJORA" widgetVar="confirmActDlg" style="font-size: 10px;">
                        <h:form id="confirmActDlgForm">
                            <p:commandButton value="SI" oncomplete="PF('confirmActDlg').hide()" update=":f:tbl, :f:growl" actionListener="#{oportunidadMB.activar}"/>
                            <p:commandButton value="NO" onclick="PF('confirmActDlg').hide()" type="button" />
                        </h:form>
                    </p:confirmDialog>

                    <p:confirmDialog appendTo="@(body)" message="Se procederÃƒÂ¡ a desactivar la oportunidad de mejora. Desea Continuar?" header="DESACTIVAR OPORTUNIDAD DE MEJORA" widgetVar="confirmDesDlg" style="font-size: 10px;">
                        <h:form id="confirmDesDlgForm">
                            <p:commandButton value="SI" oncomplete="PF('confirmDesDlg').hide()" update=":f:tbl, :f:growl" actionListener="#{oportunidadMB.desactivar}"/>
                            <p:commandButton value="NO" onclick="PF('confirmDesDlg').hide()" type="button" />
                        </h:form>
                    </p:confirmDialog>
                        
                    <p:confirmDialog appendTo="@(body)" message="Se procederÃƒÂ¡ a eliminar la oportunidad de mejora. Desea Continuar?" header="DESACTIVAR OPORTUNIDAD DE MEJORA" widgetVar="confirmDelDlg" style="font-size: 10px;">
                        <h:form id="confirmDesDelForm">
                            <p:commandButton value="SI" oncomplete="PF('confirmDelDlg').hide()" update=":f:tbl, :f:growl" actionListener="#{oportunidadMB.eliminar}"/>
                            <p:commandButton value="NO" onclick="PF('confirmDelDlg').hide()" type="button" />
                        </h:form>
                    </p:confirmDialog>    

                    <p:dialog widgetVar="statusDialog" modal="true" appendTo="@(body)"  draggable="false" closable="false" resizable="false" showHeader="false">
                        <h:graphicImage library="images" name="loading.gif" style="border: 0;" />
                    </p:dialog>
               
                      </f:view>
                </div>
            </div>
        </div>

    </ui:define>

</ui:composition>

     
